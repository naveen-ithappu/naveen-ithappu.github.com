/*! Game Of Life - v0.1 - 2014-08-11 */!function(a,b){"use strict";function c(){this.ele=b("<canvas>").css("background","#fff"),this.grahic=this.ele[0].getContext("2d")}function d(){this.ele=b('<div class="polyCanvas">')}!function(){if(a.canvasSupported=!!a.HTMLCanvasElement,a.canvas2DSupported=!!a.CanvasRenderingContext2D,!a.canvasSupported){var b=document.createElement("canvas");a.canvasSupported=!(!b.getContext||!b.getContext("2d")),a.canvas2DSupported=a.canvasSupported}}(),c.prototype.appendTo=function(a){this.ele.appendTo(a)},c.prototype.setSize=function(a,b){this.width=a,this.height=b,this.ele.attr({width:a,height:b})},c.prototype.drawGuids=function(a,b,c,d,e){this.grahic.lineWidth=1,this.grahic.strokeStyle=e||"#000000",this.grahic.beginPath();for(var f=0;a>=f;f++)this.grahic.moveTo(f*c,0),this.grahic.lineTo(f*c,this.height);for(var g=0;b>=g;g++)this.grahic.moveTo(0,g*d),this.grahic.lineTo(this.width,g*d);this.grahic.stroke()},c.prototype.drawRect=function(a,b,c,d,e,f,g){e?(f&&(this.grahic.fillStyle=f),this.grahic.fillRect(a,b,c,d)):this.grahic.clearRect(a,b,c,d),g&&this.grahic.stroke()},c.prototype.clear=function(){this.drawRect(0,0,this.ele.width(),this.ele.height())},d.prototype.appendTo=function(a){this.ele.appendTo(a)},d.prototype.setSize=function(a,b){this.width=a,this.height=b,this.ele.css({width:a,height:b})},d.prototype.drawGuids=function(a,c,d,e,f){f=f||"#000000";for(var g=0;a>=g;g++)b('<div class="guide"></div>').css({height:this.height,left:g*d,"background-color":f}).appendTo(this.ele);for(var h=0;c>=h;h++)b('<div class="guide"></div>').css({width:this.width,top:h*e,"background-color":f}).appendTo(this.ele)},d.prototype.drawRect=function(a,c,d,e,f){var g="#cell_"+[a,c,d,e].join("_"),h=this.ele.find(g);h.length||(h=b('<div class="cell" id="'+g+'">').css({left:a,top:c,width:d,height:e}).appendTo(this.ele)),h[f?"addClass":"removeClass"]("alive")},d.prototype.clear=function(){this.ele.empty()};var e={getCanvas:function(){return a.canvasSupported?new c:new d}},f=function(a,b){this.cntr=a,this.conf=b,this.init()},g=f.prototype;g.getCanvasEle=function(){return this.canvas.ele},g.drawCellAt=function(a,b,c){this.canvas.drawRect(a*this.conf.cellW,b*this.conf.cellH,this.conf.cellW,this.conf.cellH,c,!1,this.conf.enableGuides)},g.drawCells=function(a){var b,c,d,e=a.length;for(c=0;e>c;c+=1)for(b=a[c].length,d=0;b>d;d+=1)this.drawCellAt(d,c,a[c][d])},g.toggleGuids=function(a){var b=a?"#000000":"#ffffff";this.canvas.drawGuids(this.conf.nXCells,this.conf.nYCells,this.conf.cellW,this.conf.cellH,b),this.canvas.ele.css("border",a?"none":"1px solid #000000")},g.rePosition=function(){var a,b=this.ele.parent().height(),c=this.ele.height();b>c&&(a=Math.round((b-c-80)/2),this.ele.css({position:"relative",top:a+"px"}))},g.resize=function(){this.conf.width=this.conf.nXCells*this.conf.cellW,this.conf.height=this.conf.nYCells*this.conf.cellH,this.canvas.setSize(this.conf.width,this.conf.height),this.rePosition()},g.repaint=function(a,b){this.conf=b,this.canvas.clear(),this.resize(),this.toggleGuids(this.conf.enableGuides),this.drawCells(a)},g.init=function(){this.ele=b('<div class="golStage"></div>').appendTo(this.cntr),this.canvas=e.getCanvas(),this.canvas.appendTo(this.ele),this.resize()};var h=function(a,b){this.ele=a,this.cnfg=b,this.cellsArr=[],this._init()},i=h.prototype;h.DEFAULTS={nXCells:5,nYCells:5,cellW:15,cellH:15,guideWidth:1,enableGuides:!0,speed:6},i._nextGeneration=function(){var a,b,c,d,e,f,g,h,i,j=this.cellsArr,k=[],l=j.length;for(b=0;l>b;b+=1)for(a=j[b].length,k[b]=[],c=0;a>c;c+=1){e=b-1>=0?b-1:l-1,f=l-1>=b+1?b+1:0,g=c-1>=0?c-1:a-1,h=a-1>=c+1?c+1:0,i={top_left:j[e][g],top_center:j[e][c],top_right:j[e][h],left:j[b][g],right:j[b][h],bottom_left:j[f][g],bottom_center:j[f][c],bottom_right:j[f][h]};var m=0,n=0;for(var o in i)i[o]?m++:n++;var p=j[b][c],q=!1;p?2>m||m>3?q=!1:(2===m||3===m)&&(q=!0):3===m&&(q=!0),k[b][c]=q}for(d={dead:0,alive:0},b=0;l>b;b+=1)for(c=0;a>c;c+=1)k[b][c]?d.alive+=1:d.dead+=1;return d.cells=k,d},i.step=function(){isNaN(this.genrationCount)&&(this.genrationCount=0),this.genrationCount+=1;var a=this._nextGeneration();a.genNo=this.genrationCount,this.cellsArr=a.cells,this.stage.repaint(this.cellsArr,this.cnfg),this.ele.trigger("steped.gol",[a,this]),a.alive||(this.ele.trigger("alldead.gol",[a,this]),this.stop())},i.stop=function(){this.interval&&clearInterval(this.interval),this.genrationCount=0,this.ele.trigger("stopped.gol",this)},i.start=function(){this.genrationCount=0;var a=this;this.ele.trigger("started.gol",this),this.interval=setInterval(function(){a.step()},100*this.cnfg.speed)},i._initCellsState=function(a){var b,c,d=[];for(b=0;b<this.cnfg.nYCells;b+=1)for(d[b]=[],c=0;c<this.cnfg.nXCells;c+=1)d[b][c]=a&&a[b]&&a[b][c]||!1;this.cellsArr=d},i.applyPreset=function(a){if("object"==typeof a&&a){var c=!1;a.pattern&&(c=a.pattern,delete a.pattern),this.cnfg=b.extend(this.cnfg,a),this._initCellsState(c),this.stage.repaint(this.cellsArr,this.cnfg)}},i._bindeEvents=function(){function a(a){var b=g.offset(),c={};return c.x=Math.floor((a.pageX-b.left)/f.cnfg.cellW),c.y=Math.floor((a.pageY-b.top)/f.cnfg.cellH),c}function c(b){if(d){var c=a(b);f.cellsArr[c.y][c.x]=e,f.stage.drawCellAt(c.x,c.y,e)}}var d,e,f=this,g=f.stage.getCanvasEle();g.on("mousedown.gol",function(b){var c,g=a(b);d=!0,c=f.cellsArr[g.y]&&f.cellsArr[g.y][g.x],e=!c,f.cellsArr[g.y][g.x]=e,f.stage.drawCellAt(g.x,g.y,e)}),g.on("mousemove.gol",c),b("body").on("mouseup.gol",function(){d=!1})},i._init=function(){this._initCellsState(),this.stage=new f(this.ele,this.cnfg),this.stage.toggleGuids(this.cnfg.enableGuides),this.stage.drawCells(this.cellsArr),this._bindeEvents()};var j=b.fn.gol;b.fn.gol=function(a){var c,d,e=Array.prototype.slice.call(arguments,1);return d=this.each(function(){var d=b(this),f=d.data("atv.gol"),g=b.extend({},h.DEFAULTS,"object"==typeof a&&a),i="string"==typeof a&&a;f||d.data("atv.gol",f=new h(d,g)),i&&0!==i.indexOf("_")&&"function"==typeof f[i]&&(c=f[i].apply(f,e))}),void 0===c?d:c},b.fn.gol.Constructor=h,b.fn.gol.noConflict=function(){return b.fn.gol=j,this}}(window,window.jQuery),!function(a,b){"use strict";var c=b.userAgent.toLowerCase();a.isIE=-1!==c.indexOf("msie")?parseInt(c.split("msie")[1]):!1}(window,navigator),!function(a,b){"use strict";function c(){d=d||b("#main"),e=e||b("body"),d.height(e.height()-f)}var d,e,f=50;a.isIE<8?b("html").addClass("ielt8"):a.isIE<9&&b("html").addClass("ielt9"),a.isIE&&a.isIE<8&&(c(),b(a).resize(c))}(window,window.jQuery),!function(a,b){var c={},d=c["Still lifes"]={};d.Block={nXCells:10,nYCells:10,cellW:15,cellH:15,enableGuides:!0,speed:6,pattern:[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!1,!1,!1,!1,!0,!0,!1],[!1,!0,!0,!1,!1,!1,!1,!0,!0,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!1,!1,!1,!0,!0,!1,!1],[!1,!1,!1,!1,!1,!1,!0,!0,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]]},d.Beehive={nXCells:10,nYCells:10,cellW:15,cellH:15,enableGuides:!0,speed:6,pattern:[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!0,!1,!1,!0,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!0,!0,!1,!1,!1,!1,!1,!1],[!1,!0,!1,!1,!0,!1,!1,!1,!1,!1],[!1,!1,!0,!0,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]]},d.Loaf={nXCells:10,nYCells:10,cellW:15,cellH:15,enableGuides:!0,speed:6,pattern:[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!1,!1,!1,!1,!1,!1,!1],[!0,!1,!1,!0,!1,!1,!1,!1,!1,!1],[!1,!0,!1,!0,!1,!1,!1,!1,!1,!1],[!1,!1,!0,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!0,!0,!1,!1],[!1,!1,!1,!1,!1,!0,!1,!1,!0,!1],[!1,!1,!1,!1,!1,!1,!0,!1,!0,!1],[!1,!1,!1,!1,!1,!1,!1,!0,!1,!1]]};var e=c.Oscillators={};e.Toad={nXCells:10,nYCells:10,cellW:15,cellH:15,enableGuides:!1,speed:6,pattern:[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!0,!1,!1,!1],[!1,!1,!1,!0,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]]},e.Beacon={nXCells:10,nYCells:10,cellW:15,cellH:15,enableGuides:!0,speed:6,pattern:[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!0,!0,!1,!1,!1,!1,!1,!1],[!1,!1,!0,!0,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]]};var f=c.Spaceships={};f.Glider={nXCells:10,nYCells:10,cellW:15,cellH:15,enableGuides:!0,speed:6,pattern:[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!0,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!0,!1,!1,!1,!1,!1,!1],[!1,!0,!0,!0,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!0,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!0,!1,!1],[!1,!1,!1,!1,!1,!0,!0,!0,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]]},f["Lightweight spaceship"]={nXCells:10,nYCells:10,cellW:15,cellH:15,enableGuides:!0,speed:6,pattern:[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!0,!1,!1,!0,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!0,!1,!1],[!1,!1,!1,!0,!1,!1,!1,!0,!1,!1],[!1,!1,!1,!1,!0,!0,!0,!0,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1]]},a.golPatterns={getByName:function(a,d){var e=c[a]&&c[a][d];return e&&(e=b.extend({},e)),e},getNames:function(){var a=Object.keys(c),b={};return a.forEach(function(a){b[a]=Object.keys(c[a])}),b}}}(window,window.jQuery),!function(a,b){"use strict";function c(){var a={};return b.each(d.ele.configFrm.serializeArray(),function(b,c){a[c.name]=c.value}),isNaN(a.cells)?a.cells=5:(a.cells=parseInt(a.cells,10),a.cells=a.cells<0?0:a.cells>50?50:a.cells),d.ele.cells.val(a.cells),isNaN(a.cellW)?a.cellW=15:(a.cellW=parseInt(a.cellW,10),a.cellW=a.cellW<1?1:a.cellW>50?50:a.cellW),d.ele.cellW.val(a.cellW),isNaN(a.cellH)?a.cellH=15:(a.cellH=parseInt(a.cellH,10),a.cellH=a.cellH<1?1:a.cellH>50?50:a.cellH),d.ele.cellH.val(a.cellH),isNaN(a.speed)?a.speed=6:(a.speed=parseInt(a.speed,10),a.speed=a.speed<1?1:a.speed>10?10:a.speed),d.ele.speed.val(a.speed),{nXCells:a.cells,nYCells:a.cells,cellW:a.cellW,cellH:a.cellH,enableGuides:!!a.showGuides,speed:a.speed}}!function(){var a=1e3,b=60*a,c=60*b,d=24*c,e=7*d,f=30*e,g=365*f;Object.toTimeParts=function(e,h,i){var j={},k=1,l=e;return 0>l&&(k=-1,l*=k),j.y=Math.floor(l/g)*k,l%=g,j.M=Math.floor(l/f)*k,l%=f,j.d=Math.floor(l/d)*k,l%=d,j.h=Math.floor(l/c)*k,l%=c,j.m=Math.floor(l/b)*k,h&&(j.s=Math.floor(l%b/a)*k),i||Object.keys(j).forEach(function(a){0===j[a]&&delete j[a]}),j}}();var d={};d.setGameState=function(a){d.ele.canvasCntr.gol("stop"),d.ele.canvasCntr.gol("applyPreset",a),d.ele.genNum.html(0),d.ele.alive.html(0),d.ele.dead.html(0),d.ele.timeElapsed.html(0)},d.applyPreset=function(a){d.ele.cells.val(a.nXCells),d.ele.cellW.val(a.cellW),d.ele.cellH.val(a.cellH),d.ele.speed.val(a.speed),d.ele.showGuides.prop("checked",a.enableGuides),d.setGameState(a)},d.bindEvents=function(){d.ele.btnStep.click(function(){d.ele.canvasCntr.gol("step")}),d.ele.btnStart.click(function(){d.ele.canvasCntr.gol("start")}),d.ele.btnStop.click(function(){d.ele.canvasCntr.gol("stop")}),d.ele.btnApply.click(function(){var b,e=c();b=d.ele.golPresets.val(),b&&(b=b.split(","),b=a.golPatterns.getByName.apply(null,b)),e.pattern=b&&b.pattern,d.setGameState(e)}),d.ele.canvasCntr.on("steped.gol",function(a,c,e){var f=c.genNo*e.cnfg.speed*100,g="";f=Object.toTimeParts(f,!0),b.each(f,function(a,b){g+=" "+b+a}),f=g.split(" "),g=f.pop(),f.length&&(g=f.pop()+" "+g),d.ele.genNum.html(c.genNo),d.ele.alive.html(c.alive),d.ele.dead.html(c.dead),d.ele.timeElapsed.html(g||"0")}),d.ele.canvasCntr.on("stopped.gol",function(){d.ele.configBtnsWrp.removeClass("started")}),d.ele.canvasCntr.on("alldead.gol",function(){}),d.ele.canvasCntr.on("started.gol",function(){d.ele.configBtnsWrp.addClass("started")}),d.ele.on("click.accordion","[data-toggle-class]",function(){var a=b(this),c=a.data(),d=c.toggleClass,e=c.target;a.closest(e).toggleClass(d)}),d.ele.golPresets.on("change",function(){var b=d.ele.golPresets.val();d.ele.golPresetsHint[b?"hide":"show"](),b&&(b=b.split(","),b=a.golPatterns.getByName.apply(null,b)),b||(b={nXCells:10,nYCells:10,cellW:15,cellH:15,enableGuides:!0,speed:6}),d.applyPreset(b)})},d.loadPrsesets=function(){if(a.golPatterns&&a.golPatterns.getNames){var c=a.golPatterns.getNames();Object.keys(c).forEach(function(a){var e=b('<optgroup label="'+a+'"></optgroup>').appendTo(d.ele.golPresets);c[a].forEach(function(b){e.append('<option value="'+a+","+b+'">'+b+"</option>")})})}},d.init=function(a){d.ele=a,d.ele.find("[ng-query]").each(function(){var a=b(this);d.ele[a.attr("ng-query")]=a}),d.ele.canvasCntr.gol(),d.loadPrsesets(),d.bindEvents()},b(function(){d.init(b("#main"))})}(window,window.jQuery);